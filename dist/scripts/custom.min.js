var SiGL;!function(e){"use strinct";var t=function(){function e(e,t,r){this.$stateProvider=e,this.$urlRouterProvider=t,this.$locationProvider=r,this.$stateProvider.state("main",{url:"/",reloadOnSearch:!0,template:"<ui-view/>",views:{main:{templateUrl:"Views/homeview.html",controller:"SiGL.Controllers.MainController"},sidebar:{templateUrl:"Views/sidebarview.html",controller:"SiGL.Controllers.SidebarController"},navbar:{templateUrl:"Views/navigationview.html",controller:"SiGL.Controllers.NavbarController"}}}),this.$urlRouterProvider.otherwise("/")}return e.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],e}();angular.module("SiGL",["ui.router","mobile-angular-ui","leaflet-directive","SiGL.Services","SiGL.Controllers","jsonFormatter","WiM.Services","WiM.Event","SiGL.Directives"]).config(t)}(SiGL||(SiGL={}));var SiGL;!function(e){var t;!function(e){var t=function(){function e(e){this.uri=e,this.parameters=[],this.showMap=!1}return e}();e.URI=t}(t=e.Models||(e.Models={}))}(SiGL||(SiGL={})),function(){"use strict";angular.module("SiGL.Services",[])}();var __extends=this.__extends||function(e,t){function r(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);r.prototype=t.prototype,e.prototype=new r},SiGL;!function(e){var t;!function(e){"use strict";function t(e,t){return new r(e,t)}var r=function(e){function t(t,r){e.call(this,t,configuration.baseurls.services),this.$q=r,this._onResourceChanged=new WiM.Event.Delegate,this._onUriChanged=new WiM.Event.Delegate,this.loadResourceList()}return __extends(t,e),Object.defineProperty(t.prototype,"onResourceChanged",{get:function(){return this._onResourceChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onUriChanged",{get:function(){return this._onUriChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ResourceList",{get:function(){return this._resourceList},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SelectedResource",{get:function(){return this._selectedResource},set:function(e){this._selectedResource!=e&&(this._selectedResource=e,this.SelectedUri=null,this._onResourceChanged.raise(this,WiM.Event.EventArgs.Empty))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SelectedUri",{get:function(){return this._selectedUri},set:function(e){e&&this._selectedUri!=e&&(this._selectedUri=e,this._onUriChanged.raise(this,WiM.Event.EventArgs.Empty))},enumerable:!0,configurable:!0}),t.prototype.AddResource=function(e){e.name&&this._resourceList.push(e)},t.prototype.RemoveResource=function(){},t.prototype.getURL=function(e,t){var r=new WiM.Services.Helpers.RequestInfo(e,!1,0,t);return this.Execute(r)},t.prototype.loadResourceList=function(){this._resourceList=configuration.resources},t}(WiM.Services.HTTPServiceBase);t.$inject=["$http","$q"],angular.module("SiGL.Services").factory("SiGL.Services.ResourceService",t)}(t=e.Services||(e.Services={}))}(SiGL||(SiGL={})),function(){"use strict";angular.module("SiGL.Controllers",[])}();var SiGL;!function(e){var t;!function(t){"use strinct";var r=function(){function e(e,t,r){this.lat=e,this.lng=t,this.zoom=r}return e}(),i=(function(){function e(e,t,r,i,o){void 0===o&&(o=void 0),this.name=e,this.url=t,this.type=r,this.visible=i,this.layerOptions=o}return e}(),function(){function t(t,r,i,o,s){var n=this;this.$filter=r,this.Resource=i,this.mapPoint=null,this.bounds=null,this.center=null,this.layers=null,this.markers=null,this.geojson=null,t.vm=this,this.selectedUri=new e.Models.URI(""),this.waitCursor=!1,this.onMapWaitCursor=!1,this.sideBarCollapsed=!1,this.downloadable=!1,this.applicationURL=configuration.baseurls.application,this.servicesBaseURL=configuration.baseurls.services,this._onSelectedResourceHandler=new WiM.Event.EventHandler(function(){n.selectedUri=new e.Models.URI(""),n.selectedResource=i.SelectedResource}),i.onResourceChanged.subscribe(this._onSelectedResourceHandler),this._onSelectedUriHandler=new WiM.Event.EventHandler(function(){n.selectedUri=i.SelectedUri,n.requestResults=""}),i.onUriChanged.subscribe(this._onSelectedUriHandler),this.initMap(),this.leafletData=s,this.showOnMap=!1,t.$on("leafletDirectiveMap.zoomend",function(e,t){t.leafletEvent.target._animateToZoom>13?n.cursorStyle="crosshair":n.cursorStyle="hand"}),t.$watch(function(){return n.selectedUri.selectedMedia},function(e,t){n.makeRequestURL()}),t.$watch(function(){return n.selectedUri.parameters},function(e,t){if(n.makeRequestURL(),"Delineate Watershed By Location"==n.selectedUri.id)for(var r in n.selectedUri.parameters)"rcode"==n.selectedUri.parameters[r].name},!0)}return t.prototype.loadResponse=function(){var e=this;this.waitCursor=!0,this.showOnMap=!1,this.requestResults="",this.Resource.getURL(this.selectedUri.newURL,this.selectedMedia).then(function(t){e.requestResults=t.data},function(t){e.requestResults="("+t.status+") "+t.data})["finally"](function(){e.waitCursor=!1,e.showOnMap=!0})},t.prototype.makeRequestURL=function(){this.geojson={},this.downloadable=!1;for(var e=[this.selectedUri.selectedMedia],t=0;t<this.selectedUri.parameters.length;t++)e.push(this.selectedUri.parameters[t].value);var r=this.selectedUri.uri.format,i=r.apply(this.selectedUri.uri,e);return this.selectedUri.newURL=i,void 0!=this.selectedUri.availableMedia&&0==this.selectedUri.availableMedia.length&&(this.downloadable=!0),i.replace(/\{(.+?)\}/g,"")},t.prototype.changeMapRegion=function(e){this.leafletData.getMap().then(function(t){for(var r in configuration.regions){var i=configuration.regions[r];i.RegionID==e.toUpperCase()&&t.fitBounds(i.Bounds)}})},t.prototype.showResponseOnMap=function(){var e=this;this.onMapWaitCursor=!0,this.markers={},this.geojson={},this.geojson.data=this.requestResults;var t=[];this.geojson.data.features.forEach(function(e){t.push([e.geometry.coordinates[1],e.geometry.coordinates[0]])}),this.leafletData.getMap().then(function(e){e.fitBounds(t)})["finally"](function(){e.onMapWaitCursor=!1}),this.selectedUri.id.indexOf("Site")>=0&&this.selectedUri.id.indexOf("Full")<0&&(this.geojson.onEachFeature=function(e,t){var r="";angular.forEach(e.properties,function(e,t){("site_id"==t||"project_id"==t||"name"==t||"latitude"==t||"longitude"==t||"state_province"==t)&&(r+="<strong>"+t+": </strong>"+e+"</br>")}),t.bindPopup(r)}),this.selectedUri.id.indexOf("Full")>=0&&(this.geojson.onEachFeature=function(e,t){var r="";angular.forEach(e.properties,function(e,t){("SiteId"==t||"Name"==t||"latitude"==t||"longitude"==t||"State"==t)&&(r+="<strong>"+t+": </strong>"+e+"</br>")}),t.bindPopup(r)})},t.prototype.initMap=function(){this.center=new r(39,-100,4),this.layers={baselayers:configuration.basemaps,overlays:configuration.overlayedLayers,markers:this.markers,geojson:this.geojson},this.markers={},this.geojson={},L.Icon.Default.imagePath="images"},t.prototype.sm=function(e){try{}catch(t){}},t.$inject=["$scope","$filter","SiGL.Services.ResourceService","leafletBoundsHelpers","leafletData"],t}());angular.module("SiGL.Controllers").controller("SiGL.Controllers.MainController",i)}(t=e.Controllers||(e.Controllers={}))}(SiGL||(SiGL={}));var SiGL;!function(e){var t;!function(e){"use strinct";var t=function(){function e(e,t){var r=this;this.resourceService=t,e.vm=this,this._onSelectedResourceHandler=new WiM.Event.EventHandler(function(){r.selectedResource=r.resourceService.SelectedResource}),this.resourceList=t.ResourceList,t.onResourceChanged.subscribe(this._onSelectedResourceHandler)}return e.prototype.selectResource=function(e){this.resourceService.SelectedResource=e},e.prototype.selectUri=function(e){this.resourceService.SelectedUri=e},e.prototype.sm=function(e){try{}catch(t){}},e.$inject=["$scope","SiGL.Services.ResourceService"],e}();angular.module("SiGL.Controllers").controller("SiGL.Controllers.SidebarController",t)}(t=e.Controllers||(e.Controllers={}))}(SiGL||(SiGL={}));var SiGL;!function(e){var t;!function(e){"use strinct";var t,r=function(){function e(e){e.vm=this,this.sideBarCollapsed=!1,this.selectedProcedure=1}return e.prototype.setProcedureType=function(e){this.selectedProcedure!=e&&this.canUpdateProceedure(e)&&(this.selectedProcedure=e)},e.prototype.toggleSideBar=function(){this.sideBarCollapsed?this.sideBarCollapsed=!1:this.sideBarCollapsed=!0},e.prototype.canUpdateProceedure=function(e){try{switch(e){case 1:return!0;case 2:return!0;case 3:return!0;case 4:return!1;case 5:return!1;default:return!1}}catch(t){return!1}},e.prototype.sm=function(e){try{}catch(t){}},e.$inject=["$scope"],e}();!function(e){e[e.INIT=1]="INIT",e[e.IDENTIFY=2]="IDENTIFY",e[e.SELECT=3]="SELECT",e[e.REFINE=4]="REFINE",e[e.BUILD=5]="BUILD"}(t||(t={})),angular.module("SiGL.Controllers").controller("SiGL.Controllers.NavbarController",r)}(t=e.Controllers||(e.Controllers={}))}(SiGL||(SiGL={})),function(){"use strict";angular.module("SiGL.Controllers",[])}();var SiGL;!function(e){var t;!function(t){"use strinct";var r=function(){function e(e,t,r){this.lat=e,this.lng=t,this.zoom=r}return e}(),i=(function(){function e(e,t,r,i,o){void 0===o&&(o=void 0),this.name=e,this.url=t,this.type=r,this.visible=i,this.layerOptions=o}return e}(),function(){function t(t,r,i,o,s){var n=this;this.$filter=r,this.Resource=i,this.mapPoint=null,this.bounds=null,this.center=null,this.layers=null,this.markers=null,this.geojson=null,t.vm=this,this.selectedUri=new e.Models.URI(""),this.waitCursor=!1,this.onMapWaitCursor=!1,this.sideBarCollapsed=!1,this.downloadable=!1,this.applicationURL=configuration.baseurls.application,this.servicesBaseURL=configuration.baseurls.services,this._onSelectedResourceHandler=new WiM.Event.EventHandler(function(){n.selectedUri=new e.Models.URI(""),n.selectedResource=i.SelectedResource}),i.onResourceChanged.subscribe(this._onSelectedResourceHandler),this._onSelectedUriHandler=new WiM.Event.EventHandler(function(){n.selectedUri=i.SelectedUri,n.requestResults=""}),i.onUriChanged.subscribe(this._onSelectedUriHandler),this.initMap(),this.leafletData=s,this.showOnMap=!1,t.$on("leafletDirectiveMap.zoomend",function(e,t){t.leafletEvent.target._animateToZoom>13?n.cursorStyle="crosshair":n.cursorStyle="hand"}),t.$watch(function(){return n.selectedUri.selectedMedia},function(e,t){n.makeRequestURL()}),t.$watch(function(){return n.selectedUri.parameters},function(e,t){if(n.makeRequestURL(),"Delineate Watershed By Location"==n.selectedUri.id)for(var r in n.selectedUri.parameters)"rcode"==n.selectedUri.parameters[r].name},!0)}return t.prototype.loadResponse=function(){var e=this;this.waitCursor=!0,this.showOnMap=!1,this.requestResults="",this.Resource.getURL(this.selectedUri.newURL,this.selectedMedia).then(function(t){e.requestResults=t.data},function(t){e.requestResults="("+t.status+") "+t.data})["finally"](function(){e.waitCursor=!1,e.showOnMap=!0})},t.prototype.makeRequestURL=function(){this.geojson={},this.downloadable=!1;for(var e=[this.selectedUri.selectedMedia],t=0;t<this.selectedUri.parameters.length;t++)e.push(this.selectedUri.parameters[t].value);var r=this.selectedUri.uri.format,i=r.apply(this.selectedUri.uri,e);return this.selectedUri.newURL=i,void 0!=this.selectedUri.availableMedia&&0==this.selectedUri.availableMedia.length&&(this.downloadable=!0),i.replace(/\{(.+?)\}/g,"")},t.prototype.changeMapRegion=function(e){this.leafletData.getMap().then(function(t){for(var r in configuration.regions){var i=configuration.regions[r];i.RegionID==e.toUpperCase()&&t.fitBounds(i.Bounds)}})},t.prototype.showResponseOnMap=function(){var e=this;this.onMapWaitCursor=!0,this.markers={},this.geojson={},this.geojson.data=this.requestResults;var t=[];this.geojson.data.features.forEach(function(e){t.push([e.geometry.coordinates[1],e.geometry.coordinates[0]])}),this.leafletData.getMap().then(function(e){e.fitBounds(t)})["finally"](function(){e.onMapWaitCursor=!1}),this.selectedUri.id.indexOf("Site")>=0&&this.selectedUri.id.indexOf("Full")<0&&(this.geojson.onEachFeature=function(e,t){var r="";angular.forEach(e.properties,function(e,t){("site_id"==t||"project_id"==t||"name"==t||"latitude"==t||"longitude"==t||"state_province"==t)&&(r+="<strong>"+t+": </strong>"+e+"</br>")}),t.bindPopup(r)}),this.selectedUri.id.indexOf("Full")>=0&&(this.geojson.onEachFeature=function(e,t){var r="";angular.forEach(e.properties,function(e,t){("SiteId"==t||"Name"==t||"latitude"==t||"longitude"==t||"State"==t)&&(r+="<strong>"+t+": </strong>"+e+"</br>")}),t.bindPopup(r)})},t.prototype.initMap=function(){this.center=new r(39,-100,4),this.layers={baselayers:configuration.basemaps,overlays:configuration.overlayedLayers,markers:this.markers,geojson:this.geojson},this.markers={},this.geojson={},L.Icon.Default.imagePath="images"},t.prototype.sm=function(e){try{}catch(t){}},t.$inject=["$scope","$filter","SiGL.Services.ResourceService","leafletBoundsHelpers","leafletData"],t}());angular.module("SiGL.Controllers").controller("SiGL.Controllers.MainController",i)}(t=e.Controllers||(e.Controllers={}))}(SiGL||(SiGL={}));var SiGL;!function(e){var t;!function(e){"use strinct";var t=function(){function e(e,t){var r=this;this.resourceService=t,e.vm=this,this._onSelectedResourceHandler=new WiM.Event.EventHandler(function(){r.selectedResource=r.resourceService.SelectedResource}),this.resourceList=t.ResourceList,t.onResourceChanged.subscribe(this._onSelectedResourceHandler)}return e.prototype.selectResource=function(e){this.resourceService.SelectedResource=e},e.prototype.selectUri=function(e){this.resourceService.SelectedUri=e},e.prototype.sm=function(e){try{}catch(t){}},e.$inject=["$scope","SiGL.Services.ResourceService"],e}();angular.module("SiGL.Controllers").controller("SiGL.Controllers.SidebarController",t)}(t=e.Controllers||(e.Controllers={}))}(SiGL||(SiGL={}));var SiGL;!function(e){var t;!function(e){"use strinct";var t,r=function(){function e(e){e.vm=this,this.sideBarCollapsed=!1,this.selectedProcedure=1}return e.prototype.setProcedureType=function(e){this.selectedProcedure!=e&&this.canUpdateProceedure(e)&&(this.selectedProcedure=e)},e.prototype.toggleSideBar=function(){this.sideBarCollapsed?this.sideBarCollapsed=!1:this.sideBarCollapsed=!0},e.prototype.canUpdateProceedure=function(e){try{switch(e){case 1:return!0;case 2:return!0;case 3:return!0;case 4:return!1;case 5:return!1;default:return!1}}catch(t){return!1}},e.prototype.sm=function(e){try{}catch(t){}},e.$inject=["$scope"],e}();!function(e){e[e.INIT=1]="INIT",e[e.IDENTIFY=2]="IDENTIFY",e[e.SELECT=3]="SELECT",e[e.REFINE=4]="REFINE",e[e.BUILD=5]="BUILD"}(t||(t={})),angular.module("SiGL.Controllers").controller("SiGL.Controllers.NavbarController",r)}(t=e.Controllers||(e.Controllers={}))}(SiGL||(SiGL={}));